% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{u_center}
\alias{u_center}
\title{U-center a Symmetric Matrix}
\usage{
u_center(A)
}
\arguments{
\item{A}{A symmetric numeric matrix to be U-centered}
}
\value{
A U-centered matrix of the same dimensions as the input, with zeros on the diagonal
}
\description{
Performs U-centering on a symmetric matrix, which is a technique that provides
an unbiased estimator by removing diagonal elements and applying appropriate
centering. U-centering is commonly used in statistical tests based on distance
or kernel matrices, such as HSIC and distance covariance.
}
\details{
For a symmetric matrix A, the U-centered matrix is calculated as:

U(A) = A + (total sum)/((n-1)(n-2)) - (row sum)/(n-2) - (col sum)/(n-2)

where row sum and column sum are identical since A is symmetric, total sum is the
sum of all elements in A, and n is the size of the matrix. The diagonal elements
are set to zero.

U-centering provides an unbiased estimator for kernel and distance-based measures,
which is particularly important for small sample sizes. This implementation uses Rcpp
for improved computational efficiency with large matrices.
}
\examples{
# Create sample data
set.seed(123)
X <- matrix(rnorm(100), nrow = 20)  # 20 observations in 5D

# Generate a Gaussian kernel matrix using KDist_matrix
K <- KDist_matrix(X)

# Apply U-centering to the kernel matrix
K_u_centered <- u_center(K)

# Verify properties of U-centered matrix
# Diagonal should be zero
diag_elements <- diag(K_u_centered)
print(all(diag_elements == 0))

# Row and column sums (off-diagonal elements) should be approximately zero
row_sums <- rowSums(K_u_centered)
print(all(abs(row_sums) < 1e-10))

}
\seealso{
\code{\link{v_center}} for V-centering
\code{\link{hsic}} for Hilbert-Schmidt Independence Criterion
\code{\link{dcov}} for distance covariance
}
