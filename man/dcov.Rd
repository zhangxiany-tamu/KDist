% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/KDist.R
\name{dcov}
\alias{dcov}
\title{Distance Covariance Between Two Samples}
\usage{
dcov(x, y, a = 1, u_center = FALSE, is_distance = FALSE)
}
\arguments{
\item{x}{First dataset or distance matrix}

\item{y}{Second dataset or distance matrix}

\item{a}{Exponent parameter for Euclidean distance, default is 1}

\item{u_center}{Logical; use U-centering instead of V-centering (default: FALSE)}

\item{is_distance}{Logical; whether input matrices are already distance matrices (default: FALSE)}
}
\value{
The squared distance covariance value between the two samples
}
\description{
Calculates the squared distance covariance between two multivariate samples, which
measures the dependence between random vectors.
}
\details{
The squared distance covariance between two samples is defined as:

\deqn{dcov^2(X, Y) = E[||X - X'||^a · ||Y - Y'||^a] + E[||X - X'||^a] · E[||Y - Y'||^a]
               - 2E[||X - X'||^a · ||Y - Y''||^a]}

where \eqn{||\cdot||} denotes Euclidean distance, \eqn{(X', Y')} and \eqn{(X'', Y'')} are independent copies
of \eqn{(X, Y)}, and a is typically set to 1.

Distance covariance has several important properties:
\itemize{
\item \eqn{dcov^2(X, Y) \geq 0} for all distributions of \eqn{X} and \eqn{Y}
\item \eqn{dcov^2(X, Y) = 0} if and only if \eqn{X} and \eqn{Y} are independent
\item It can detect both linear and non-linear dependence
\item It is applicable to vectors of arbitrary dimensions
}

When u_center = FALSE (default), the function computes the V-statistic version.
When u_center = TRUE, it computes the U-statistic version that's unbiased.
}
\examples{
# Example 1: Distance covariance between independent samples
set.seed(123)
x <- matrix(rnorm(100), ncol = 1)
y <- matrix(rnorm(100), ncol = 1)
dcov_indep <- dcov(x, y)
print(paste("Distance covariance (independent):", round(dcov_indep, 6)))

# Example 2: Distance covariance with linear relationship
x <- matrix(runif(100), ncol = 1)
y <- matrix(x + 0.1*rnorm(100), ncol = 1)  # Linear relationship with noise
dcov_linear <- dcov(x, y)
print(paste("Distance covariance (linear):", round(dcov_linear, 6)))

# Example 3: Distance covariance with non-linear relationship
x <- matrix(runif(100, -3, 3), ncol = 1)
y <- matrix(x^2 + 0.1*rnorm(100), ncol = 1)  # Quadratic relationship
dcov_nonlinear <- dcov(x, y)
print(paste("Distance covariance (non-linear):", round(dcov_nonlinear, 6)))

# Example 4: Comparing V-statistic and U-statistic estimators
dcov_v <- dcov(x, y, u_center = FALSE)  # Default, V-statistic
dcov_u <- dcov(x, y, u_center = TRUE)   # U-statistic (unbiased)
print(c("V-statistic" = dcov_v, "U-statistic" = dcov_u))

# Example 5: Using multivariate data
x_multi <- matrix(rnorm(200), ncol = 2)
y_multi <- cbind(x_multi[,1] + rnorm(100, sd = 0.1),
                 x_multi[,2]^2 + rnorm(100, sd = 0.1))
dcov_multi <- dcov(x_multi, y_multi)
print(paste("Multivariate distance covariance:", round(dcov_multi, 6)))

# Example 6: Using pre-computed distance matrices
Dx <- as.matrix(dist(x_multi))
Dy <- as.matrix(dist(y_multi))
dcov_precomp <- dcov(Dx, Dy, is_distance = TRUE)
print(paste("Using pre-computed matrices:", round(dcov_precomp, 6)))

}
\references{
Székely, G. J., Rizzo, M. L., & Bakirov, N. K. (2007). Measuring and testing dependence by
correlation of distances. \emph{The Annals of Statistics}, 35(6), 2769-2794.
}
\seealso{
\code{\link{dcor}} for distance correlation,
\code{\link{hsic}} for Hilbert-Schmidt Independence Criterion,
\code{\link{ed}} for energy distance
}
