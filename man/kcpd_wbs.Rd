% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/change_point.R
\name{kcpd_wbs}
\alias{kcpd_wbs}
\title{Wild Binary Segmentation for Multiple Change Point Detection using Kernel Metrics}
\usage{
kcpd_wbs(
  data,
  type = "e-dist",
  bw = NULL,
  expo = 1,
  scale_factor = 0.5,
  group = NULL,
  M = 50,
  B = 299,
  alpha = 0.05,
  seeds = NULL,
  num_cores = 1
)
}
\arguments{
\item{data}{A matrix or data frame with rows representing time points (observations) and
columns representing variables or features.}

\item{type}{Type of distance or kernel to use (default: "e-dist"). Options include:
\itemize{
\item "euclidean": Euclidean distance
\item "gaussian": Gaussian kernel
\item "laplacian": Laplacian kernel
\item "polynomial": Polynomial kernel
\item "e-dist": Euclidean-based aggregated distance (for high-dimensional data)
\item "g-dist": Gaussian kernel-based aggregated distance
\item "l-dist": Laplacian kernel-based aggregated distance
}}

\item{bw}{Bandwidth parameter for kernel calculations. If NULL (default), it will be automatically determined.}

\item{expo}{Exponent parameter for distance calculation (default: 1).}

\item{scale_factor}{Scaling factor for automatic bandwidth calculation (default: 0.5).}

\item{group}{Optional vector specifying group membership for each variable/column.
Used for group-wise distance calculations in "e-dist", "g-dist", or "l-dist".}

\item{M}{Number of random intervals to consider (default: 50).
Higher values increase computational cost but may improve accuracy.}

\item{B}{Number of permutations for p-value calculation (default: 299).}

\item{alpha}{Significance level for determining whether a change point is significant (default: 0.05).}

\item{seeds}{Random seed for reproducibility. If NULL, no seed is set.}

\item{num_cores}{Number of cores for parallel processing (default: 1).
If NULL, will use one less than the available number of cores.}
}
\value{
A list containing:
\item{locations}{A vector of detected change point locations (indices)}
\item{pvalues}{A vector of p-values corresponding to each detected change point}
\item{cluster}{A vector of cluster assignments for each observation, where each segment
between change points is assigned a unique integer}
}
\description{
Detects multiple change points in time series or sequential data using the Wild Binary Segmentation
(WBS) method combined with kernel-based metrics. This approach is particularly effective for
high-dimensional data and can detect various types of changes in distribution beyond just mean shifts.
}
\details{
This function implements a multiple change point detection approach that combines:
\enumerate{
\item The Wild Binary Segmentation (WBS) methodology from Fryzlewicz (2014), which uses
a random set of intervals at multiple scales to search for change points
\item The kernel-based testing framework from Chakraborty & Zhang (2021), which enables
detection of general distributional changes even in high-dimensional settings
}

The algorithm works by:
\enumerate{
\item Randomly selecting M subintervals of the data
\item Applying the kernel-based test statistic to each interval independently
\item Identifying the interval with the maximum test statistic
\item If significant, recursively applying the procedure to the segments before and after
the detected change point
\item Returning the final set of change points with their p-values and segment assignments
}
}
\examples{
# Example: High-dimensional data with multiple change points
set.seed(123)
n <- 150  # Total sample size
p <- 200  # Number of dimensions (high-dimensional setting)

# Generate high-dimensional data with two change points at t=50 and t=100
X1 <- matrix(rnorm(50 * p), nrow = 50, ncol = p)                # First segment
X2 <- matrix(rnorm(50 * p, mean = 0.5), nrow = 50, ncol = p)    # Second segment
X3 <- matrix(rnorm(50 * p, mean = 0), nrow = 50, ncol = p)      # Third segment

# Combine data
X <- rbind(X1, X2, X3)

# Detect change points using WBS
result <- kcpd_wbs(X, type = "e-dist", M = 50)

print(result$locations)  # Should be close to 50 and 100
print(result$pvalues)    # Should be < 0.05
print(table(result$cluster))  # Should show 3 segments

}
\references{
Fryzlewicz, P. (2014). Wild binary segmentation for multiple change-point detection.
\emph{The Annals of Statistics}, 42(6), 2243-2281.

Chakraborty, S., & Zhang, X. (2021). High-dimensional Change-point Detection Using
Generalized Homogeneity Metrics. arXiv:2105.08976.
}
\seealso{
\code{\link{kcpd_single}} for single change point detection
\code{\link{kcpd_sbs}} for change point detection using Seeded Binary Segmentation
\code{\link{adjustedRandIndex}} for evaluating change point detection results
}
