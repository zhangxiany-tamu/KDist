% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/KDist.R
\name{ed}
\alias{ed}
\title{Energy Distance Between Two Samples}
\usage{
ed(x, y = NULL, a = 1, u_center = FALSE, n = NULL, m = NULL)
}
\arguments{
\item{x}{First sample or full distance matrix if y is NULL}

\item{y}{Second sample (optional)}

\item{a}{Exponent parameter for Euclidean distance, default is 1}

\item{u_center}{Logical; use U-centering instead of V-centering}

\item{n}{Size of first sample (required if x is a distance matrix)}

\item{m}{Size of second sample (required if x is a distance matrix)}
}
\value{
The energy distance value between the two samples
}
\description{
Calculates the energy distance between two multivariate samples, which is a measure of the
difference between distributions.
}
\details{
The energy distance between two samples is defined as:

\deqn{E(X, Y) = 2E[||X - Y||^a] - E[||X - X'||^a] - E[||Y - Y'||^a]}

where \eqn{||\cdot||} denotes Euclidean distance, and \eqn{(X', Y')} is an independent copy of \eqn{(X, Y)}.

This implementation is based on the method proposed by Székely and Rizzo (2004).
Energy distance is a measure of statistical distance between probability
distributions, and has the property that \eqn{E(F, G)\geq 0} with equality if and
only if \eqn{F = G} (where \eqn{F} and \eqn{G} are the distributions from which \eqn{X} and \eqn{Y} are sampled).
}
\examples{
# Example 1: Energy distance between samples from the same distribution
set.seed(123)
x <- matrix(rnorm(100 * 3), ncol = 3)  # 100 observations in 3D from N(0,1)
y <- matrix(rnorm(80 * 3), ncol = 3)   # 80 observations in 3D from N(0,1)
ed_same <- ed(x, y)
print(paste("Energy distance (same distribution):", round(ed_same, 4)))

# Example 2: Energy distance between samples from different distributions
set.seed(456)
x <- matrix(rnorm(100 * 2), ncol = 2)  # 100 observations in 2D from N(0,1)
y <- matrix(rnorm(100 * 2, mean = 1), ncol = 2)  # 100 observations in 2D from N(1,1)
ed_diff <- ed(x, y)
print(paste("Energy distance (different means):", round(ed_diff, 4)))

# Example 3: Using different exponent values
ed_a1 <- ed(x, y, a = 1)  # Default
ed_a2 <- ed(x, y, a = 2)  # Squared Euclidean distance
print(c("a=1" = ed_a1, "a=2" = ed_a2))

# Example 4: Using U-centering instead of V-centering
ed_v <- ed(x, y, u_center = FALSE)  # Default, V-statistic
ed_u <- ed(x, y, u_center = TRUE)   # U-statistic (unbiased)
print(c("V-statistic" = ed_v, "U-statistic" = ed_u))

# Example 5: Using vector inputs
x_vec <- rnorm(50)
y_vec <- rnorm(50, mean = 0.5)
ed_vec <- ed(x_vec, y_vec)
print(paste("Energy distance with vectors:", round(ed_vec, 4)))

# Example 6: Using a pre-computed distance matrix
combined <- rbind(x, y)
D <- as.matrix(dist(combined)^1)  # ^1 for a=1
n_x <- nrow(x)
m_y <- nrow(y)
ed_precomp <- ed(D, n = n_x, m = m_y)
print(paste("Using pre-computed matrix:", round(ed_precomp, 4)))

}
\references{
Székely, G. J., & Rizzo, M. L. (2004). Testing for Equal Distributions in High Dimension.
InterStat, Nov. (5).

Székely, G. J., & Rizzo, M. L. (2013). Energy statistics: A class of statistics based on
distances. Journal of Statistical Planning and Inference, 143(8), 1249-1272.
}
\seealso{
\code{\link{mmd}} for Maximum Mean Discrepancy, \code{\link{dcov}} for distance covariance
}
